<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Games: Add Game</title>
    <link rel="stylesheet" href="/css/global.css" />
    <link rel="stylesheet" href="/css/games/add-game.css" />
  </head>
  <body>
    <%- include('../partials/header.ejs') %>

    <main>
      <h2>Game Details</h2>

      <form action="/games/add-game" method="POST">
        <section class="form-group">
          <label for="name">Name</label>
          <input
            type="text"
            name="name"
            id="name"
            required
            placeholder="Enter name"
          />
        </section>

        <section class="form-group">
          <div class="label-buttons">
            <label for="developer">Developer</label>
            <div class="buttons-container">
              <button type="button" onclick="addDeveloperSelect()">Add</button>
            </div>
          </div>

          <div class="select-container developer">
            <select name="developer" id="developer">
              <option value="" disabled selected>Select Developer</option>
              <% developers.forEach((developer) => { %>
              <option value="<%= developer.name %>">
                <%= developer.name %>
              </option>
              <% }); %>
            </select>
          </div>
        </section>

        <section class="form-group">
          <div class="label-buttons">
            <label for="genre">Genre</label>
            <div class="buttons-container">
              <button type="button" onclick="addGenreSelect()">Add</button>
            </div>
          </div>

          <div class="select-container genre">
            <select name="genre" id="genre">
              <option value="" disabled selected>Select Genre</option>
              <% genres.forEach((genre) => { %>
              <option value="<%= genre.name %>"><%= genre.name %></option>
              <% }); %>
            </select>
          </div>
        </section>

        <section class="form-group">
          <label for="stock">Stock</label>
          <input
            type="number"
            name="stock"
            id="stock"
            min="0"
            required
            placeholder="Enter stock"
          />
        </section>

        <section class="button-group">
          <a href="/games">Back</a>
          <button type="submit">+ Game</button>
        </section>
      </form>
    </main>

    <%- include('../partials/footer.ejs') %>

    <script>
      function addDeveloperSelect() {
        const selectContainer = document.querySelector(
          ".select-container.developer"
        );
        const currentSelect = document.querySelector(
          ".select-container.developer select"
        );
        const newSelect = document.createElement("select");

        newSelect.name = "developer";
        newSelect.innerHTML = currentSelect.innerHTML;
        selectContainer.appendChild(newSelect);
      }

      function addGenreSelect() {
        const selectContainer = document.querySelector(
          ".select-container.genre"
        );
        const currentSelect = document.querySelector(
          ".select-container.genre select"
        );
        const newSelect = document.createElement("select");

        newSelect.name = "genre";
        newSelect.innerHTML = currentSelect.innerHTML;
        selectContainer.appendChild(newSelect);
      }
    </script>
  </body>
</html>
